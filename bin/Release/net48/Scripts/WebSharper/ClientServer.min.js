(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;a=self;b=a.testFrom0=a.testFrom0||{};c=b.Client=b.Client||{};d=a.GeneratedPrintf=a.GeneratedPrintf||{};e=a.ClientServer_JsonEncoder=a.ClientServer_JsonEncoder||{};f=a.ClientServer_JsonDecoder=a.ClientServer_JsonDecoder||{};g=a.WebSharper;h=g&&g.Html;i=h&&h.Client;j=i&&i.Tags;k=g&&g.Concurrency;l=g&&g.Owin;m=l&&l.WebSocket;n=m&&m.Client;o=n&&n.WithEncoding;p=a.JSON;q=a.IntelliFactory;r=q&&q.Runtime;s=g&&g.Utils;t=a.jQuery;u=g&&g.UI;v=u&&u.Next;w=v&&v.Var;x=v&&v.Submitter;y=v&&v.View;z=g&&g.Remoting;A=z&&z.AjaxRemotingProvider;B=v&&v.Doc;C=v&&v.AttrProxy;D=g&&g.Strings;E=g&&g.Arrays;F=g&&g.ClientSideJson;G=F&&F.Provider;c.Send=function(H){var I,J;function K(L){return L(function(M){I.Dom.appendChild(self.document.createTextNode(M+"\n"));});}I=j.Tags().NewTag("pre",[]);k.Start((J=null,k.Delay(function(){return k.Bind(o.ConnectStateful(function(L){return p.stringify((e.j())(L));},function(L){return(f.j())(p.parse(L));},H,function(){var L;L=null;return k.Delay(function(){return k.Return([0,function(M){return function(N){var O;O=null;return k.Delay(function(){var P;return N.$==3?(K(function(Q){return Q("WebSocket connection closed.");}),k.Return(M)):N.$==2?(K(function(Q){return Q("WebSocket connection open.");}),k.Return(M)):N.$==1?(K(function(Q){return Q("WebSocket connection error!");}),k.Return(M)):(P=N.$0,k.Combine(P.$==3?(((K(r.Curried3(function(Q,R,S){return Q("MessageFromServer_String "+s.toSafe(R)+" \r\n(state: "+a.String(S)+")");})))(P.$0))(M),k.Zero()):(K(function(Q){return Q("invalidMessage");}),k.Zero()),k.Delay(function(){return k.Return(M+1);})));});};}]);});}),function(L){L.Post({$:3,$0:"kickOff"});return k.Zero();});})),null);I.HtmlProvider.SetAttribute(I.get_Body(),"id","console");return I;};c.WS=function(H){var I,J;function K(L){return L(function(M){I.Dom.appendChild(self.document.createTextNode(M+"\n"));});}I=j.Tags().NewTag("pre",[]);k.Start((J=null,k.Delay(function(){var L;K(function(M){return M("Checking regression #4...");});t.ajax((L={},L.url="/ws.txt",L.method="GET",L.success=function(M){return(K(function(N){return function(O){return N(s.toSafe(O));};}))(M);},L.error=function(M,N,O){return(K(function(P){return function(Q){return P("KO: "+s.toSafe(Q)+".");};}))(O);},L));return k.Bind(o.ConnectStateful(function(M){return p.stringify((e.j())(M));},function(M){return(f.j())(p.parse(M));},H,function(){var M;M=null;return k.Delay(function(){return k.Return([0,function(N){return function(O){var P;P=null;return k.Delay(function(){var Q;return O.$==3?(K(function(R){return R("WebSocket connection closed.");}),k.Return(N)):O.$==2?(K(function(R){return R("WebSocket connection open.");}),k.Return(N)):O.$==1?(K(function(R){return R("WebSocket connection error!");}),k.Return(N)):(Q=O.$0,k.Combine(Q.$==0?(((K(r.Curried3(function(R,S,T){return R("Response2 "+a.String(S)+" (state: "+a.String(T)+")");})))(Q.$0))(N),k.Zero()):Q.$==2?((K(function(R){return function(S){return R("Resp3 "+d.p(S));};}))(Q.$0),k.Zero()):Q.$==3?((K(function(R){return function(S){return R("MessageFromServer_String "+s.prettyPrint(S));};}))(Q.$0),k.Zero()):(((K(r.Curried3(function(R,S,T){return R("Response1 "+s.toSafe(S)+" (state: "+a.String(T)+")");})))(Q.$0))(N),k.Zero()),k.Delay(function(){return k.Return(N+1);})));});};}]);});}),function(M){var N;N=M.get_Connection();return k.While(function(){return true;},k.Delay(function(){return k.Bind(k.Sleep(1000),function(){N.send(p.stringify((e.j())({$:2,$0:{name:{"first-name":"John00",LastName:"Doe"},age:42}})));return k.Zero();});}));});})),null);return I;};c.fsiCmd=function(){var H,I,J;H=w.Create$1("");I=x.CreateOption(H.v);J=y.MapAsync(function(K){var L;return K!=null&&K.$==1?(new A.New()).Async("ClientServer:testFrom0.Server.fsiExecute:-1840423385",[K.$0]):(L=null,k.Delay(function(){return k.Return("");}));},I.view);return B.Element("div",[],[B.Element("div",[],[B.Button("Send",[],function(){I.Trigger();}),B.Button("Clear Console",[],function(){t("#console").empty();}),B.Element("br",[],[]),B.InputArea([C.Create("style","width: 800px"),C.Create("class","input"),C.Create("rows","10"),C.Create("value","printfn \"orz\"")],H)]),B.Element("hr",[],[]),B.Element("h4",[C.Create("class","text-muted")],[B.TextNode("The server responded:")]),B.Element("div",[],[B.Element("h1",[],[B.TextView(J)])])]);};c.m2=function(){var H,I,J;H=w.Create$1("orz");I=y.Map(function(K){return(function(L){return function(M){return L("You entered "+a.String(M)+" characters.");};}(a.id))(K);},y.Map(D.length,H.v));J=B.BindView(function(K){return B.Concat(E.map(function(L){return B.Element("li",[],[B.TextNode(L)]);},K));},y.Map(function(K){return D.SplitChars(K,[" "],0);},H.v));return B.Element("div",[],[B.Element("div",[],[B.Input([],H),B.TextView(I)]),B.Element("div",[],[B.TextNode("You entered the following words:"),B.Element("ul",[],[J])])]);};c.Main=function(){var H,I,J;H=w.Create$1("");I=x.CreateOption(H.v);J=y.MapAsync(function(K){var L;return K!=null&&K.$==1?(new A.New()).Async("ClientServer:testFrom0.Server.DoSomething:-1840423385",[K.$0]):(L=null,k.Delay(function(){return k.Return("");}));},I.view);B.RunById("navbar",B.Element("div",[],[B.TextNode("This goes into #main.")]));return B.Element("div",[],[B.Input([],H),B.Button("Send",[],function(){I.Trigger();}),B.Element("hr",[],[]),B.Element("h4",[C.Create("class","text-muted")],[B.TextNode("The server responded:")]),B.Element("div",[C.Create("class","jumbotron")],[B.Element("h1",[],[B.TextView(J)])])]);};d.p=function(H){return"{"+("FirstName = "+s.prettyPrint(H["first-name"]))+"; "+("LastName = "+s.prettyPrint(H.LastName))+"}";};e.j=function(){return e._v?e._v:e._v=(G.EncodeUnion(void 0,{cmd:3,age:2,"int":1,str:0},[["Request1",[["$0","str",G.EncodeArray(G.Id()),0]]],["Request2",[["$0","int",G.EncodeArray(G.Id()),0]]],["Req3",[[null,true,G.Id()]]],["MessageFromClient",[["$0","cmd",G.Id(),0]]]]))();};f.j=function(){return f._v?f._v:f._v=(G.DecodeUnion(void 0,"type",[["int",[["$0","value",G.Id(),0]]],["string",[["$0","value",G.Id(),0]]],["name",[["$0","value",G.Id(),0]]],["msgStr",[["$0","value",G.Id(),0]]]]))();};}());
