(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U;b=a.FAkka=a.FAkka||{};c=b.Shared=b.Shared||{};d=c.UI=c.UI||{};e=d.Server=d.Server||{};f=e.Name=e.Name||{};g=e.User=e.User||{};h=d.Client=d.Client||{};i=h.JHelper=h.JHelper||{};j=a.StartupCode$ClientServer$Client=a.StartupCode$ClientServer$Client||{};k=a.ClientServer_JsonDecoder=a.ClientServer_JsonDecoder||{};l=a.ClientServer_JsonEncoder=a.ClientServer_JsonEncoder||{};m=a.GeneratedPrintf=a.GeneratedPrintf||{};n=a.WebSharper;o=n&&n.Unchecked;p=n&&n.JavaScript;q=p&&p.Pervasives;r=n&&n.Html;s=r&&r.Client;t=s&&s.Tags;u=n&&n.Concurrency;v=a.jQuery;w=n&&n.Utils;x=n&&n.AspNetCore;y=x&&x.WebSocket;z=y&&y.Client;A=z&&z.WithEncoding;B=a.JSON;C=a.IntelliFactory;D=C&&C.Runtime;E=n&&n.Remoting;F=E&&E.AjaxRemotingProvider;G=n&&n.UI;H=G&&G.Var$1;I=n&&n.Strings;J=n&&n.Arrays;K=G&&G.Submitter;L=G&&G.View;M=n&&n.Seq;N=n&&n.MatchFailureException;O=G&&G.Doc;P=G&&G.AttrProxy;Q=G&&G.Client;R=Q&&Q.Templates;S=a.Date;T=n&&n.ClientSideJson;U=T&&T.Provider;f.New=function(V,W){return{"first-name":V,LastName:W};};g.New=function(V,W){return{name:V,age:W};};i.append=function(V,W,X){V[W]=i.add((o.Equals(q.GetJS(V,[W]),void 0)?V[W]=[]:void 0,V[W]),X);return V;};i.add=function(V,W){return V.concat(W);};h.WS=function(V){var W,X;function Y(Z){return Z(function(_0){W.Dom.appendChild(self.document.createTextNode(_0+"\n"));});}W=t.Tags().NewTag("pre",[]);u.Start((X=null,u.Delay(function(){var Z;Y(function(_0){return _0("Checking regression #4...");});v.ajax((Z={},Z.url="/ws.txt",Z.method="GET",Z.success=function(_0){return(Y(function(_1){return function(_2){return _1(w.toSafe(_2));};}))(_0);},Z.error=function(_0,_1,_2){return(Y(function(_3){return function(_4){return _3("KO: "+w.toSafe(_4)+".");};}))(_2);},Z));return u.Bind(A.ConnectStateful(function(_0){return B.stringify((l.j())(_0));},function(_0){return(k.j())(B.parse(_0));},V,function(){var _0;_0=null;return u.Delay(function(){return u.Return([0,function(_1){return function(_2){var _3;_3=null;return u.Delay(function(){var _4;return _2.$==3?(Y(function(_5){return _5("WebSocket connection closed.");}),u.Return(_1)):_2.$==2?(Y(function(_5){return _5("WebSocket connection open.");}),u.Return(_1)):_2.$==1?(Y(function(_5){return _5("WebSocket connection error!");}),u.Return(_1)):(_4=_2.$0,u.Combine(_4.$==0?(((Y(D.Curried3(function(_5,_6,_7){return _5("Response2 "+a.String(_6)+" (state: "+a.String(_7)+")");})))(_4.$0))(_1),u.Zero()):_4.$==2?((Y(function(_5){return function(_6){return _5("Resp3 "+m.p(_6));};}))(_4.$0),u.Zero()):_4.$==3?((Y(function(_5){return function(_6){return _5("MessageFromServer_String "+w.prettyPrint(_6));};}))(_4.$0),u.Zero()):(((Y(D.Curried3(function(_5,_6,_7){return _5("Response1 "+w.toSafe(_6)+" (state: "+a.String(_7)+")");})))(_4.$0))(_1),u.Zero()),u.Delay(function(){return u.Return(_1+1);})));});};}]);});}),function(_0){var _1;_1=_0.get_Connection();return u.While(function(){return true;},u.Delay(function(){return u.Bind(u.Sleep(1000),function(){_1.send(B.stringify((l.j())({$:2,$0:g.New(f.New("John00","Doe"),42)})));return u.Zero();});}));});})),null);return W;};h.fsiCmd$268$26=D.Curried3(function(V,W,X){return v("#filteredResult").val(V.Get());});h.fsiCmd=function(V){var W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg;function bh(bi){var bj,bk;return bi!=null&&bi.$==1?(bj=bi.$0,(_8.Set(_8.Get().concat([bj])),bb.Set(bb.Get()+1),(new F.New()).Async("ClientServer:FAkka.Shared.UI.Server.fsiExecute:1074071197",[bj]))):(bk=null,u.Delay(function(){return u.Bind((new F.New()).Async("ClientServer:FAkka.Shared.UI.Server.fsiSeq:-71915202",[]),function(bl){return u.Return(["",bl]);});}));}W=H.Create$1("v:\\");X=H.Create$1("v:\\result.csv");Y=H.Create$1(false);Z=H.Create$1("5");_0=H.Create$1("6");_1=H.Create$1("8");_2=H.Create$1("9");_3=H.Create$1("3");_4=H.Create$1("4");_5=H.Create$1("20200712");_6=H.Create$1("20200720");_7=H.Create$1("");_8=H.Create$1([]);_9=H.Lens(h.filterResult(),function(bi){var bj;bj=new a.RegExp(h.filterKeyWord().Get());return I.concat("",J.filter(function(bk){return bj.test(bk);},bi));},function(bi,bj){return bi.concat([bj]);});_=H.Create$1("named script");$=H.Create$1("");ba=H.Create$1(V);bb=H.Create$1(0);bc=K.CreateOption(_7.get_View());bd=K.CreateOption($.get_View());be=K.CreateOption(_8.get_View());bf=L.Map(function(bi){var bj,bk;bj=M.nth(0,bi);bk=M.nth(1,bi);return bj[1]>bk[1]?bj[0]:bk[0];},L.Sequence([L.MapAsync(bh,bc.view),L.MapAsync(bh,bd.view)]));L.MapAsync(function(bi){var bj,bk;if(bi!=null&&bi.$==1){if(J.length(bi.$0)===0)return(new F.New()).Async("ClientServer:FAkka.Shared.UI.Server.getHisCmds:-1916767346",[]);else if(bi!=null&&bi.$==1){bj=bi.$0;bk=null;return u.Delay(function(){return u.Return(bj);});}else throw new N.New("Client.fs",253,33);}else return(new F.New()).Async("ClientServer:FAkka.Shared.UI.Server.getHisCmds:-1916767346",[]);},be.view);bg=O.Input([P.Create("id","fKW"),P.Create("style","width: 880px"),P.Create("class","input"),P.Create("rows","1")],h.filterKeyWord()).on("blur",function(){return v("#filteredResult").val(_9.Get());});return O.Element("div",[],[O.Element("div",[],[O.Button("Send",[],function(){bc.Trigger();}),O.Button("SendSingle",[],function(){bd.Trigger();}),O.Button("Clear Console",[],function(){v("#console").empty();}),O.Button("Clear Command",[],function(){v("#fsiCmd").val("");}),O.Button("Last Command",[],function(){var bi;u.Start((bi=null,u.Delay(function(){return u.Bind((new F.New()).Async("ClientServer:FAkka.Shared.UI.Server.getHisCmd:2048691399",[]),function(bj){v("#fsiCmd").val(bj);return u.Zero();});})),null);}),O.Button("Previous Command",[],function(){var bi;J.length(_8.Get())===0?u.Start((bi=null,u.Delay(function(){return u.Bind((new F.New()).Async("ClientServer:FAkka.Shared.UI.Server.getHisCmds:-1916767346",[]),function(bj){_8.Set(bj);return u.Combine(J.length(_8.Get())>0?(bb.Set(J.length(_8.Get())-1),u.Zero()):u.Zero(),u.Delay(function(){_7.Set(J.get(_8.Get(),bb.Get()));return u.Zero();}));});})),null):(bb.Get()===0?bb.Set(J.length(_8.Get())-1):bb.Set(bb.Get()-1),_7.Set(J.get(_8.Get(),bb.Get())));be.Trigger();}),O.Button("Get Script",[],function(){var bi;u.Start((bi=null,u.Delay(function(){return u.Bind((new F.New()).Async("ClientServer:FAkka.Shared.UI.Server.getNamedScript:1890332917",[a.String(v("#nScript").val())]),function(bj){v("#fsiCmd").val(bj);_7.Set(bj);return u.Zero();});})),null);}),O.Button("Save Script",[],function(){var bi;u.Start((bi=null,u.Delay(function(){return u.Bind((new F.New()).Async("ClientServer:FAkka.Shared.UI.Server.upsertNamedScript:60259177",[a.String(v("#nScript").val()),a.String(v("#fsiCmd").val())]),function(bj){v("#fsiCmd").val(bj);return u.Zero();});})),null);}),O.Button("List Script",[],function(){var bi;u.Start((bi=null,u.Delay(function(){return u.Bind((new F.New()).Async("ClientServer:FAkka.Shared.UI.Server.listNamedScripts:-1916767346",[]),function(bj){var bk;bk=J.fold(function(bl,bm){return bl!==""?bl+"\r\n"+bm:bm;},"",bj);v("#nScript").val("");v("#fsiCmd").val(bk);return u.Zero();});})),null);}),O.Button("Clear Result Cache",[],function(){h.filterResult().Set([]);}),O.Element("br",[],[]),O.Button("ConnectTo",[],function(){u.Start(h.Send3(a.String(v("#webSocket2").val())),null);}),O.Input([P.Create("id","fast1"),P.Create("style","width: 50px")],Z),O.Input([P.Create("id","fast2"),P.Create("style","width: 50px")],_0),O.Input([P.Create("id","slow1"),P.Create("style","width: 50px")],_1),O.Input([P.Create("id","slow2"),P.Create("style","width: 50px")],_2),O.Input([P.Create("id","period1"),P.Create("style","width: 50px")],_3),O.Input([P.Create("id","period2"),P.Create("style","width: 50px")],_4),O.Element("br",[],[]),O.Element("div",[P.Create("style","display:inline-block")],[O.Element("div",[P.Create("style","display:inline-block")],[O.TextNode("folder of input files: ")]),O.Input([P.Create("id","ipp"),P.Create("style","width: 440px; display:inline-block")],W)]),O.Element("div",[],[O.Element("div",[P.Create("style","display:inline-block")],[O.TextNode("output file: ")]),O.Input([P.Create("id","opf"),P.Create("style","width: 440px; display:inline-block")],X)]),O.CheckBox([P.Create("id","ifReadAllMode")],Y),O.Button("RunColdFar",[],function(){var bi,bj,bk,bl,bm,bn,bo;bi=Z.Get();bj=_0.Get();bk=_1.Get();bl=_2.Get();bm=_3.Get();bn=_4.Get();bo="#r @\".\\dowSim002.exe\"\n"+"open dowSim002\n"+"open System.Reflection\n"+"main [| @\""+W.Get()+"\"; \""+bi+"\"; \""+bj+"\"; \""+bk+"\"; \""+bl+"\"; \""+bm+"\"; \""+bn+"\"; @\""+X.Get()+"\""+(!Y.Get()?"":"; \""+_5.Get()+"\""+"; \""+_6.Get()+"\"")+" |]";_7.Set(bo);v("#fsiCmd").val(bo);}),O.Element("br",[],[]),O.InputArea([P.Create("id","webSocket2"),P.Create("style","width: 880px"),P.Create("class","input"),P.Create("rows","1")],ba),O.Element("br",[],[]),bg,O.InputArea([P.Create("id","nScript"),P.Create("style","width: 880px"),P.Create("class","input"),P.Create("rows","1")],_),O.InputArea([P.Create("id","fsiCmd"),P.Create("style","width: 880px"),P.Create("class","input"),P.Create("rows","10"),P.Create("value","printfn \"orz\"")],_7),O.InputArea([P.Create("id","singleCmd"),P.Create("style","width: 880px"),P.Create("class","input"),P.Create("rows","1")],$)]),O.Element("hr",[],[]),O.InputArea([P.Create("id","filteredResult"),P.Create("style","width: 880px"),P.Create("class","input"),P.Create("rows","10")],_9),O.Element("h4",[P.Create("class","text-muted")],[O.TextNode("The server responded:")]),O.Element("div",[],[O.Element("h1",[],[O.TextView(bf)])])]);};h.Send3=function(V){var W;!o.Equals(h.socketServer().Get(),null)?h.socketServer().Get().$0.get_Connection().close():void 0;W=null;return u.Delay(function(){var X,Y;return u.Bind(u.Parallel([(X=null,u.Delay(function(){return u.Bind((new F.New()).Async("ClientServer:FAkka.Shared.UI.Server.MD5Hash:1890332917",[V]),function(Z){return u.Return({$:0,$0:Z});});})),(Y=null,u.Delay(function(){return u.Bind((new F.New()).Async("ClientServer:FAkka.Shared.UI.Server.getPort:929898232",[V]),function(Z){return u.Return({$:1,$0:Z});});}))]),function(Z){var _0,_1,_2;if(!o.Equals(Z,null)&&Z.length===2&&(J.get(Z,0).$==0&&(J.get(Z,1).$==1&&(_0=[J.get(Z,1).$0,J.get(Z,0).$0],true)))){_1=_0[0];_2=_0[1];v("#console").empty().ready(function(){return h.Send2(_1,_2);});return u.Zero();}else throw new N.New("Client.fs",151,16);});});};h.Send2=function(V,W){var X;function Y(_0){return I.PadLeftWith(a.String(_0),2,"0");}function Z(_0){return _0(function(_1){var _2;H.Set(h.filterResult(),h.filterResult().Get().concat([_1+"\n"]));_2=O.TextNode(_1+"\n");R.LoadLocalTemplates("");O.RunAppendById("console",_2);});}u.Start((X=null,u.Delay(function(){return u.Bind(A.ConnectStateful(function(_0){return B.stringify((l.j())(_0));},function(_0){return(k.j())(B.parse(_0));},V,function(){var _0;_0=null;return u.Delay(function(){return u.Return([0,function(_1){return function(_2){var _3;_3=null;return u.Delay(function(){var _4,_5;return _2.$==3?(Z(function(_6){return _6("WebSocket connection closed.");}),u.Return(_1)):_2.$==2?(Z(function(_6){return _6("WebSocket connection open.");}),u.Return(_1)):_2.$==1?(Z(function(_6){return _6("WebSocket connection error!");}),u.Return(_1)):(_4=_2.$0,u.Combine(_4.$==3?(_5=S.now(),(((((((Z(D.Curried(function(_6,_7,_8,_9,_,$,ba){return _6("["+w.toSafe(_7)+"]["+w.toSafe(_8)+w.toSafe(_9)+w.toSafe(_)+"]["+a.String($)+"] "+w.toSafe(ba));},7)))(W))(Y((new S(_5)).getHours())))(Y((new S(_5)).getMinutes())))(Y((new S(_5)).getSeconds())))(_1))(_4.$0),u.Zero())):(Z(function(_6){return _6("invalidMessage");}),u.Zero()),u.Delay(function(){return u.Return(_1+1);})));});};}]);});}),function(_0){h.socketServer().Set({$:1,$0:_0});_0.Post({$:3,$0:"kickOff"});return u.Zero();});})),null);};h.socketServer=function(){j.$cctor();return j.socketServer;};h.content=function(){j.$cctor();return j.content;};h.filterKeyWord=function(){j.$cctor();return j.filterKeyWord;};h.filterResult=function(){j.$cctor();return j.filterResult;};h.m2=function(){var V,W,X;V=H.Create$1("orz");W=L.Map(function(Y){return(function(Z){return function(_0){return Z("You entered "+a.String(_0)+" characters.");};}(a.id))(Y);},L.Map(I.length,V.get_View()));X=O.BindView(function(Y){return O.Concat(J.map(function(Z){return O.Element("li",[],[O.TextNode(Z)]);},Y));},L.Map(function(Y){return I.SplitChars(Y,[" "],0);},V.get_View()));return O.Element("div",[],[O.Element("div",[],[O.Input([],V),O.TextView(W)]),O.Element("div",[],[O.TextNode("You entered the following words:"),O.Element("ul",[],[X])])]);};h.Main=function(){var V,W,X;V=H.Create$1("");W=K.CreateOption(V.get_View());X=L.MapAsync(function(Y){var Z;return Y!=null&&Y.$==1?(new F.New()).Async("ClientServer:FAkka.Shared.UI.Server.DoSomething:1890332917",[Y.$0]):(Z=null,u.Delay(function(){return u.Return("");}));},W.view);return O.Element("div",[],[O.Input([],V),O.Button("Send",[],function(){W.Trigger();}),O.Element("hr",[],[]),O.Element("h4",[P.Create("class","text-muted")],[O.TextNode("The server responded:")]),O.Element("div",[P.Create("class","jumbotron")],[O.Element("h1",[],[O.TextView(X)])])]);};j.$cctor=function(){j.$cctor=a.ignore;j.filterResult=H.Create$1([]);j.filterKeyWord=H.Create$1("");j.content=H.Create$1("");j.socketServer=H.Create$1(null);};k.j=function(){return k._v?k._v:k._v=(U.DecodeUnion(void 0,"type",[["int",[["$0","value",U.Id(),0]]],["string",[["$0","value",U.Id(),0]]],["name",[["$0","value",U.Id(),0]]],["msgStr",[["$0","value",U.Id(),0]]]]))();};l.j=function(){return l._v?l._v:l._v=(U.EncodeUnion(void 0,{cmd:3,age:2,"int":1,str:0},[["Request1",[["$0","str",U.EncodeArray(U.Id()),0]]],["Request2",[["$0","int",U.EncodeArray(U.Id()),0]]],["Req3",[[null,true,U.Id()]]],["MessageFromClient",[["$0","cmd",U.Id(),0]]]]))();};m.p=function(V){return"{"+("FirstName = "+w.prettyPrint(V["first-name"]))+"; "+("LastName = "+w.prettyPrint(V.LastName))+"}";};}(self));
