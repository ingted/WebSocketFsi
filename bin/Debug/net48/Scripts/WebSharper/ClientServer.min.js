(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N;a=self;b=a.testFrom0=a.testFrom0||{};c=b.Client=b.Client||{};d=c.JHelper=c.JHelper||{};e=a.StartupCode$ClientServer$Client=a.StartupCode$ClientServer$Client||{};f=a.ClientServer_JsonEncoder=a.ClientServer_JsonEncoder||{};g=a.GeneratedPrintf=a.GeneratedPrintf||{};h=a.ClientServer_JsonDecoder=a.ClientServer_JsonDecoder||{};i=a.WebSharper;j=i&&i.Unchecked;k=i&&i.JavaScript;l=k&&k.Pervasives;m=i&&i.UI;n=m&&m.Next;o=n&&n.Var;p=i&&i.Html;q=p&&p.Client;r=q&&q.Tags;s=i&&i.Concurrency;t=i&&i.Owin;u=t&&t.WebSocket;v=u&&u.Client;w=v&&v.WithEncoding;x=a.JSON;y=a.IntelliFactory;z=y&&y.Runtime;A=i&&i.Utils;B=a.jQuery;C=i&&i.Remoting;D=C&&C.AjaxRemotingProvider;E=i&&i.Strings;F=i&&i.Arrays;G=n&&n.Submitter;H=n&&n.View;I=i&&i.Seq;J=i&&i.MatchFailureException;K=n&&n.Doc;L=n&&n.AttrProxy;M=i&&i.ClientSideJson;N=M&&M.Provider;d.append=function(O,P,Q){O[P]=d.add((j.Equals(l.GetJS(O,[P]),void 0)?O[P]=[]:void 0,O[P]),Q);return O;};d.add=function(O,P){return O.concat(P);};c.Send=function(O){var P,Q;function R(S){return S(function(T){o.Set(c.filterResult(),c.filterResult().c.concat([T+"\n"]));P.Dom.appendChild(self.document.createTextNode(T+"\n"));});}P=r.Tags().NewTag("pre",[]);s.Start((Q=null,s.Delay(function(){return s.Bind(w.ConnectStateful(function(S){return x.stringify((f.j())(S));},function(S){return(h.j())(x.parse(S));},O,function(){var S;S=null;return s.Delay(function(){return s.Return([0,function(T){return function(U){var V;V=null;return s.Delay(function(){var W,X;return U.$==3?(R(function(Y){return Y("WebSocket connection closed.");}),s.Return(T)):U.$==2?(R(function(Y){return Y("WebSocket connection open.");}),s.Return(T)):U.$==1?(R(function(Y){return Y("WebSocket connection error!");}),s.Return(T)):(W=U.$0,s.Combine(W.$==3?(X=new a.Date(),((((R(z.Curried(function(Y,Z,_0,_1){return Y("["+A.toSafe(Z)+"]["+a.String(_0)+"] "+A.toSafe(_1));},4)))(X.toTimeString()))(T))(W.$0),s.Zero())):(R(function(Y){return Y("invalidMessage");}),s.Zero()),s.Delay(function(){return s.Return(T+1);})));});};}]);});}),function(S){S.Post({$:3,$0:"kickOff"});return s.Zero();});})),null);P.HtmlProvider.SetAttribute(P.get_Body(),"id","console");return P;};c.WS=function(O){var P,Q;function R(S){return S(function(T){P.Dom.appendChild(self.document.createTextNode(T+"\n"));});}P=r.Tags().NewTag("pre",[]);s.Start((Q=null,s.Delay(function(){var S;R(function(T){return T("Checking regression #4...");});B.ajax((S={},S.url="/ws.txt",S.method="GET",S.success=function(T){return(R(function(U){return function(V){return U(A.toSafe(V));};}))(T);},S.error=function(T,U,V){return(R(function(W){return function(X){return W("KO: "+A.toSafe(X)+".");};}))(V);},S));return s.Bind(w.ConnectStateful(function(T){return x.stringify((f.j())(T));},function(T){return(h.j())(x.parse(T));},O,function(){var T;T=null;return s.Delay(function(){return s.Return([0,function(U){return function(V){var W;W=null;return s.Delay(function(){var X;return V.$==3?(R(function(Y){return Y("WebSocket connection closed.");}),s.Return(U)):V.$==2?(R(function(Y){return Y("WebSocket connection open.");}),s.Return(U)):V.$==1?(R(function(Y){return Y("WebSocket connection error!");}),s.Return(U)):(X=V.$0,s.Combine(X.$==0?(((R(z.Curried3(function(Y,Z,_0){return Y("Response2 "+a.String(Z)+" (state: "+a.String(_0)+")");})))(X.$0))(U),s.Zero()):X.$==2?((R(function(Y){return function(Z){return Y("Resp3 "+g.p(Z));};}))(X.$0),s.Zero()):X.$==3?((R(function(Y){return function(Z){return Y("MessageFromServer_String "+A.prettyPrint(Z));};}))(X.$0),s.Zero()):(((R(z.Curried3(function(Y,Z,_0){return Y("Response1 "+A.toSafe(Z)+" (state: "+a.String(_0)+")");})))(X.$0))(U),s.Zero()),s.Delay(function(){return s.Return(U+1);})));});};}]);});}),function(T){var U;U=T.get_Connection();return s.While(function(){return true;},s.Delay(function(){return s.Bind(s.Sleep(1000),function(){U.send(x.stringify((f.j())({$:2,$0:{name:{"first-name":"John00",LastName:"Doe"},age:42}})));return s.Zero();});}));});})),null);return P;};c.fsiCmd=function(){var O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_;function $(ba){var bb,bc;return ba!=null&&ba.$==1?(bb=ba.$0,(o.Set(_0,_0.c.concat([bb])),o.Set(_5,_5.c+1),(new D.New()).Async("ClientServer:testFrom0.Server.fsiExecute:-1840423385",[bb]))):(bc=null,s.Delay(function(){return s.Return("");}));}O=o.Create$1("v:\\");P=o.Create$1("v:\\result.csv");Q=o.Create$1(false);R=o.Create$1("5");S=o.Create$1("6");T=o.Create$1("8");U=o.Create$1("9");V=o.Create$1("3");W=o.Create$1("4");X=o.Create$1("20200712");Y=o.Create$1("20200720");Z=o.Create$1("");_0=o.Create$1([]);_1=o.Lens(c.filterResult(),function(ba){var bb;bb=new a.RegExp(c.filterKeyWord().c);return E.concat("",F.filter(function(bc){return bb.test(bc);},ba));},function(ba,bb){return ba.concat([bb]);});_2=o.Create$1("named script");_3=o.Create$1("");_4=o.Create$1("http://localhost:8080/");_5=o.Create$1(0);_6=G.CreateOption(Z.v);_7=G.CreateOption(_3.v);_8=G.CreateOption(_0.v);_9=H.Map(function(ba){return I.nth(0,ba)+" "+I.nth(1,ba);},H.Sequence([H.MapAsync($,_6.view),H.MapAsync($,_7.view)]));H.MapAsync(function(ba){var bb,bc;if(ba!=null&&ba.$==1){if(F.length(ba.$0)===0)return(new D.New()).Async("ClientServer:testFrom0.Server.getHisCmds:-118046996",[]);else if(ba!=null&&ba.$==1){bb=ba.$0;bc=null;return s.Delay(function(){return s.Return(bb);});}else throw new J.New("Client.fs",273,33);}else return(new D.New()).Async("ClientServer:testFrom0.Server.getHisCmds:-118046996",[]);},_8.view);_=K.Input([L.Create("id","fKW"),L.Create("style","width: 880px"),L.Create("class","input"),L.Create("rows","1")],c.filterKeyWord()).on("blur",function(){return B("#filteredResult").val(_1.RVal());});return K.Element("div",[],[K.Element("div",[],[K.Button("Send",[],function(){_6.Trigger();}),K.Button("SendSingle",[],function(){_7.Trigger();}),K.Button("Clear Console",[],function(){B("#console").empty();}),K.Button("Clear Command",[],function(){B("#fsiCmd").val("");}),K.Button("Last Command",[],function(){var ba;s.Start((ba=null,s.Delay(function(){return s.Bind((new D.New()).Async("ClientServer:testFrom0.Server.getHisCmd:-447555547",[]),function(bb){B("#fsiCmd").val(bb);return s.Zero();});})),null);}),K.Button("Previous Command",[],function(){var ba;F.length(_0.c)===0?s.Start((ba=null,s.Delay(function(){return s.Bind((new D.New()).Async("ClientServer:testFrom0.Server.getHisCmds:-118046996",[]),function(bb){o.Set(_0,bb);return s.Combine(F.length(_0.c)>0?(o.Set(_5,F.length(_0.c)-1),s.Zero()):s.Zero(),s.Delay(function(){o.Set(Z,F.get(_0.c,_5.c));return s.Zero();}));});})),null):(_5.c===0?o.Set(_5,F.length(_0.c)-1):o.Set(_5,_5.c-1),o.Set(Z,F.get(_0.c,_5.c)));_8.Trigger();}),K.Button("Get Script",[],function(){var ba;s.Start((ba=null,s.Delay(function(){return s.Bind((new D.New()).Async("ClientServer:testFrom0.Server.getNamedScript:-1840423385",[a.String(B("#nScript").val())]),function(bb){B("#fsiCmd").val(bb);o.Set(Z,bb);return s.Zero();});})),null);}),K.Button("Save Script",[],function(){var ba;s.Start((ba=null,s.Delay(function(){return s.Bind((new D.New()).Async("ClientServer:testFrom0.Server.upsertNamedScript:2040152023",[a.String(B("#nScript").val()),a.String(B("#fsiCmd").val())]),function(bb){B("#fsiCmd").val(bb);return s.Zero();});})),null);}),K.Button("List Script",[],function(){var ba;s.Start((ba=null,s.Delay(function(){return s.Bind((new D.New()).Async("ClientServer:testFrom0.Server.listNamedScripts:-118046996",[]),function(bb){var bc;bc=F.fold(function(bd,be){return bd!==""?bd+"\r\n"+be:be;},"",bb);B("#nScript").val("");B("#fsiCmd").val(bc);return s.Zero();});})),null);}),K.Button("Clear Result Cache",[],function(){o.Set(c.filterResult(),[]);}),K.Element("br",[],[]),K.Button("ConnectTo",[],function(){s.Start(c.Send3(a.String(B("#webSocket2").val())),null);}),K.Input([L.Create("id","fast1"),L.Create("style","width: 50px")],R),K.Input([L.Create("id","fast2"),L.Create("style","width: 50px")],S),K.Input([L.Create("id","slow1"),L.Create("style","width: 50px")],T),K.Input([L.Create("id","slow2"),L.Create("style","width: 50px")],U),K.Input([L.Create("id","period1"),L.Create("style","width: 50px")],V),K.Input([L.Create("id","period2"),L.Create("style","width: 50px")],W),K.Element("br",[],[]),K.Element("div",[L.Create("style","display:inline-block")],[K.Element("div",[L.Create("style","display:inline-block")],[K.TextNode("folder of input files: ")]),K.Input([L.Create("id","ipp"),L.Create("style","width: 440px; display:inline-block")],O)]),K.Element("div",[],[K.Element("div",[L.Create("style","display:inline-block")],[K.TextNode("output file: ")]),K.Input([L.Create("id","opf"),L.Create("style","width: 440px; display:inline-block")],P)]),K.CheckBox([L.Create("id","ifReadAllMode")],Q),K.Button("RunColdFar",[],function(){var ba;ba="#r @\".\\dowSim002.exe\"\n"+"open dowSim002\n"+"open System.Reflection\n"+"main [| @\""+O.c+"\"; \""+R.c+"\"; \""+S.c+"\"; \""+T.c+"\"; \""+U.c+"\"; \""+V.c+"\"; \""+W.c+"\"; @\""+P.c+"\""+(!Q.c?"":"; \""+X.c+"\""+"; \""+Y.c+"\"")+" |]";o.Set(Z,ba);B("#fsiCmd").val(ba);}),K.Element("br",[],[]),K.InputArea([L.Create("id","webSocket2"),L.Create("style","width: 880px"),L.Create("class","input"),L.Create("rows","1")],_4),K.Element("br",[],[]),_,K.InputArea([L.Create("id","nScript"),L.Create("style","width: 880px"),L.Create("class","input"),L.Create("rows","1")],_2),K.InputArea([L.Create("id","fsiCmd"),L.Create("style","width: 880px"),L.Create("class","input"),L.Create("rows","10"),L.Create("value","printfn \"orz\"")],Z),K.InputArea([L.Create("id","singleCmd"),L.Create("style","width: 880px"),L.Create("class","input"),L.Create("rows","1")],_3)]),K.Element("hr",[],[]),K.InputArea([L.Create("id","filteredResult"),L.Create("style","width: 880px"),L.Create("class","input"),L.Create("rows","10")],_1),K.Element("h4",[L.Create("class","text-muted")],[K.TextNode("The server responded:")]),K.Element("div",[],[K.Element("h1",[],[K.TextView(_9)])])]);};c.Send3=function(O){var P;!j.Equals(c.socketServer().c,null)?c.socketServer().c.$0.get_Connection().close():void 0;P=null;return s.Delay(function(){return s.Bind((new D.New()).Async("ClientServer:testFrom0.Server.MD5Hash:-1840423385",[O]),function(Q){return s.Bind((new D.New()).Async("ClientServer:testFrom0.Server.getPort:1510873242",[O]),function(R){B("#console").empty().ready(function(){return c.Send2(R,Q);});return s.Zero();});});});};c.Send2=function(O,P){var Q;function R(S){return S(function(T){o.Set(c.filterResult(),c.filterResult().c.concat([T+"\n"]));K.RunAppendById("console",K.TextNode(T+"\n"));});}s.Start((Q=null,s.Delay(function(){return s.Bind(w.ConnectStateful(function(S){return x.stringify((f.j())(S));},function(S){return(h.j())(x.parse(S));},O,function(){var S;S=null;return s.Delay(function(){return s.Return([0,function(T){return function(U){var V;V=null;return s.Delay(function(){var W,X;return U.$==3?(R(function(Y){return Y("WebSocket connection closed.");}),s.Return(T)):U.$==2?(R(function(Y){return Y("WebSocket connection open.");}),s.Return(T)):U.$==1?(R(function(Y){return Y("WebSocket connection error!");}),s.Return(T)):(W=U.$0,s.Combine(W.$==3?(X=new a.Date(),((((((((((R(z.Curried(function(Y,Z,_0,_1,_2,_3,_4,_5,_6,_7){return Y("["+A.toSafe(Z)+"]["+a.String(_0)+"-"+a.String(_1)+"-"+a.String(_2)+" "+a.String(_3)+":"+a.String(_4)+":"+a.String(_5)+"]["+a.String(_6)+"] "+A.toSafe(_7));},10)))(P))(X.getFullYear()))(X.getMonth()))(X.getUTCDay()))(X.getUTCHours()))(X.getUTCHours()))(X.getUTCSeconds()))(T))(W.$0),s.Zero())):(R(function(Y){return Y("invalidMessage");}),s.Zero()),s.Delay(function(){return s.Return(T+1);})));});};}]);});}),function(S){o.Set(c.socketServer(),{$:1,$0:S});S.Post({$:3,$0:"kickOff"});return s.Zero();});})),null);};c.socketServer=function(){e.$cctor();return e.socketServer;};c.content=function(){e.$cctor();return e.content;};c.filterKeyWord=function(){e.$cctor();return e.filterKeyWord;};c.filterResult=function(){e.$cctor();return e.filterResult;};c.m2=function(){var O,P,Q;O=o.Create$1("orz");P=H.Map(function(R){return(function(S){return function(T){return S("You entered "+a.String(T)+" characters.");};}(a.id))(R);},H.Map(E.length,O.v));Q=K.BindView(function(R){return K.Concat(F.map(function(S){return K.Element("li",[],[K.TextNode(S)]);},R));},H.Map(function(R){return E.SplitChars(R,[" "],0);},O.v));return K.Element("div",[],[K.Element("div",[],[K.Input([],O),K.TextView(P)]),K.Element("div",[],[K.TextNode("You entered the following words:"),K.Element("ul",[],[Q])])]);};c.Main=function(){var O,P,Q;O=o.Create$1("");P=G.CreateOption(O.v);Q=H.MapAsync(function(R){var S;return R!=null&&R.$==1?(new D.New()).Async("ClientServer:testFrom0.Server.DoSomething:-1840423385",[R.$0]):(S=null,s.Delay(function(){return s.Return("");}));},P.view);K.RunById("navbar",K.Element("div",[],[K.TextNode("This goes into #main.")]));return K.Element("div",[],[K.Input([],O),K.Button("Send",[],function(){P.Trigger();}),K.Element("hr",[],[]),K.Element("h4",[L.Create("class","text-muted")],[K.TextNode("The server responded:")]),K.Element("div",[L.Create("class","jumbotron")],[K.Element("h1",[],[K.TextView(Q)])])]);};e.$cctor=function(){e.$cctor=a.ignore;e.filterResult=o.Create$1([]);e.filterKeyWord=o.Create$1("");e.content=o.Create$1("");e.socketServer=o.Create$1(null);};f.j=function(){return f._v?f._v:f._v=(N.EncodeUnion(void 0,{cmd:3,age:2,"int":1,str:0},[["Request1",[["$0","str",N.EncodeArray(N.Id()),0]]],["Request2",[["$0","int",N.EncodeArray(N.Id()),0]]],["Req3",[[null,true,N.Id()]]],["MessageFromClient",[["$0","cmd",N.Id(),0]]]]))();};g.p=function(O){return"{"+("FirstName = "+A.prettyPrint(O["first-name"]))+"; "+("LastName = "+A.prettyPrint(O.LastName))+"}";};h.j=function(){return h._v?h._v:h._v=(N.DecodeUnion(void 0,"type",[["int",[["$0","value",N.Id(),0]]],["string",[["$0","value",N.Id(),0]]],["name",[["$0","value",N.Id(),0]]],["msgStr",[["$0","value",N.Id(),0]]]]))();};}());
